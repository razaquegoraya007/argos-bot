'use strict';var _Rh;
{let g,k,f,l,m;const d=_Sf.storage.sync;let y=(a,c)=>{"sync"==c?k||_mt(function*(){_7p(a.del("asd"))||(yield v());if(f){let b=f;f=null;b()}}):"local"!=c||_7p(a.del("LOCAL","__dummy__"))||(_Rh&&!l&&w("sameBrwr"==_Rh),g&&!m&&x(b=>{b&&b.size>b.quota&&_O(["LOCAL","remoteSync"],"",0)}))},q,h=function(a){a=!!(null==a?_Rh||g:a);a==!q&&(_Sf.storage.onChanged[a?"addListener":"removeListener"](y),q=a)};var _xj=function(a){_Rh=a;h()},_xk=function(a){g=a;h()},_3f=_qf(function*(){h(!0);yield _eg(a=>f=a,a=>d.set({["asd"]:Math.random()},
a));yield _ks(a=>f=a,_Fy(73>_Zo?2500:250));f=null;h()});let r=()=>a=>_gs()(c=>a(_Bt(JSON.stringify(c),"UTF-8",!1))),t=a=>JSON.parse(_Ej(a,"UTF-8"));var _fi=_qf(function*(){yield _3f();var a=yield r();"compress"==g&&(a=yield _jw(a));a=btoa(a);const c=d.QUOTA_BYTES_PER_ITEM-50;let b={};for(var e=0;e*c<a.length;++e)b[e]=a.substr(e*c,c);if(e>=d.QUOTA_BYTES/d.QUOTA_BYTES_PER_ITEM&&(a=JSON.stringify(b).length,a>d.QUOTA_BYTES))return{size:a,quota:d.QUOTA_BYTES};k=!0;yield n=>d.clear(n);yield n=>d.set(b,
n);k=!1});let u=a=>`settings${a?"_"+_ik:""}.dat`,p=a=>c=>{const b=["LOCAL","localSyncTime"];a?_O(b,a,0,c):_Mt(...b)(c)};var _Ei=_qf(function*(a){(yield _7d(u(a),yield r()))||(yield p(Date.now()),yield _ky(_es,[_4r,{space:a?_ik:""}]))});let w=_1d(-500,(...a)=>_Ei(...a)()),x=_1d(-600,a=>_fi()(a));var _0i=_qf(function*(){let a=yield b=>d.get(b),c="";for(let b=0;a[b];++b)c+=a[b];try{let b=atob(c),e=yield _lu(b);return[t(e),b!=e]}catch(b){}return[{}]}),_ke=_qf(function*(a,c){if(c)var b=yield p();a=yield _tj(u(a),
null,b);!1!==a&&(yield p(Date.now()));try{return t(a.content)}catch(e){}return{}});let v=_qf(function*(){if(g){let [a]=yield _0i();_7p(a)||(_Rh&&(yield _Xk("add",a)),m=!0,yield _wy(a),m=!1)}});var _dh=_ug(function*(a){_Rh&&(a=yield _ke("sameBrwr"==_Rh,a),_7p(a)||(l=!0,yield _wy(a),l=!1))}),_ue=a=>{a.space==("sameBrwr"==_Rh?_ik:"")&&_dh()}};
